{"version":3,"file":"forum.js","sources":["../src/forum/components/UserSubmissionApplicationSubmitSuccessModal.tsx","../src/types/index.ts","../src/forum/services/UserSubmissionAPI.ts","../src/forum/components/UserSubmissionApplicationModal.tsx","../src/forum/components/UserSubmissionWidget.tsx","../src/forum/model/UserSubmission.ts","../src/common/components/EmptyState.tsx","../src/common/components/LoadMoreButton.tsx","../src/common/components/ListContainer.tsx","../src/forum/components/UserSubmissionApplicationListItem.tsx","../src/common/hooks/usePagination.ts","../src/forum/components/UserSubmissionApplicationListPage.tsx","../src/forum/components/UserSubmissionApplicationPage.tsx","../src/forum/addUserPage.ts","../src/forum/components/UserSubmissionNotification.tsx","../src/forum/components/UserSubmissionIndexPage.tsx","../src/forum/index.ts"],"sourcesContent":["import app from 'flarum/forum/app';\r\nimport Modal from 'flarum/common/components/Modal';\r\nimport Button from 'flarum/common/components/Button';\r\n\r\nexport default class UserSubmissionApplicationSubmitSuccessModal extends Modal {\r\n  static isDismissibleViaBackdropClick = false;\r\n  static isDismissibleViaCloseButton = true;\r\n\r\n  oninit(vnode: any) {\r\n    super.oninit(vnode);\r\n  }\r\n\r\n  className(): string {\r\n    return 'Modal--small';\r\n  }\r\n\r\n  title(): string {\r\n    return app.translator.trans('wusong8899-user-submission.forum.submit-success');\r\n  }\r\n\r\n  content() {\r\n    return (\r\n      <div className=\"Modal-body\">\r\n        <div className=\"Form\">\r\n          <div className=\"Form-group\" style=\"text-align: center;\">\r\n            {Button.component(\r\n              {\r\n                className: 'Button Button--primary',\r\n                onclick: () => {\r\n                  this.hide();\r\n                },\r\n              },\r\n              app.translator.trans('wusong8899-user-submission.lib.ok')\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import User from 'flarum/models/User';\n\n/**\n * Review result type - strictly typed enum\n */\nexport type UserSubmissionReviewResult = 'approved' | 'rejected';\n\n/**\n * Review status type including pending state\n */\nexport type UserSubmissionReviewStatus = 'pending' | 'approved' | 'rejected';\n\n/**\n * Enhanced User Submission model interface with strict typing\n */\nexport interface UserSubmissionAttributes {\n  readonly id: string;\n  amount: number;\n  user_account: string;\n  submission_user_id: string;\n  review_user_id: string | null;\n  review_result: UserSubmissionReviewResult | null;\n  assigned_at: Date;\n  reviewed_at: Date | null;\n  created_at: Date;\n  updated_at: Date;\n}\n\n/**\n * User Submission model with relationships\n */\nexport interface UserSubmissionData extends UserSubmissionAttributes {\n  fromUser: User;\n  reviewUser: User | null;\n}\n\n/**\n * API response for user submission list\n */\nexport interface UserSubmissionListResponse {\n  data: UserSubmissionData[];\n  meta?: {\n    total: number;\n    page: number;\n    per_page: number;\n  };\n}\n\n/**\n * API request payload for creating user submission\n */\nexport interface CreateUserSubmissionPayload {\n  amount: number;\n  userAccount: string;\n}\n\n/**\n * API request payload for updating user submission with strict typing\n */\nexport interface UpdateUserSubmissionPayload {\n  review_result?: UserSubmissionReviewResult;\n  review_user_id?: string;\n}\n\n/**\n * Component props for modals\n */\nexport interface ModalProps {\n  onsubmit?: () => void;\n  onhide?: () => void;\n}\n\n/**\n * Component props for user submission components\n */\nexport interface UserSubmissionComponentProps {\n  userSubmission: UserSubmissionData;\n  onUpdate?: (userSubmission: UserSubmissionData) => void;\n  onDelete?: (id: string) => void;\n}\n\n/**\n * Stream type for form inputs\n */\nexport type StreamType<T> = {\n  (): T;\n  (value: T): T;\n};\n\n/**\n * Form state interface\n */\nexport interface UserSubmissionFormState {\n  amount: StreamType<string>;\n  userAccount: StreamType<string>;\n  loading: boolean;\n}\n\n/**\n * Review modal state interface with strict typing\n */\nexport interface ReviewModalState {\n  reviewResult: StreamType<UserSubmissionReviewResult | ''>;\n  loading: boolean;\n}\n\n/**\n * Enhanced API response wrapper with error handling\n */\nexport interface ApiResponse<T = any> {\n  data: T;\n  meta?: MetaInformation;\n  errors?: ApiError[];\n}\n\n/**\n * Standardized API error interface\n */\nexport interface ApiError {\n  status: string;\n  code?: string;\n  title: string;\n  detail?: string;\n  source?: {\n    pointer?: string;\n    parameter?: string;\n  };\n}\n\n/**\n * Meta information from API responses\n */\nexport interface MetaInformation {\n  total?: number;\n  page?: number;\n  per_page?: number;\n  [key: string]: any;\n}\n\n/**\n * Validation error type for forms\n */\nexport interface ValidationError {\n  field: string;\n  message: string;\n}\n\n/**\n * Enhanced UserSubmission service interface\n */\nexport interface UserSubmissionService {\n  list(params?: ListParams): Promise<UserSubmissionListResponse>;\n  create(payload: CreateUserSubmissionPayload): Promise<UserSubmissionData>;\n  update(id: string, payload: UpdateUserSubmissionPayload): Promise<UserSubmissionData>;\n  delete(id: string): Promise<void>;\n  validate(data: Partial<CreateUserSubmissionPayload>): ValidationError[];\n}\n\n/**\n * List parameters for API queries\n */\nexport interface ListParams {\n  page?: number;\n  limit?: number;\n  filter?: Record<string, any>;\n  sort?: string;\n  include?: string[];\n}\n\n/**\n * Constants for user submission system\n */\nexport const USER_SUBMISSION_CONSTANTS = {\n  REVIEW_RESULTS: {\n    APPROVED: 'approved' as const,\n    REJECTED: 'rejected' as const,\n  },\n  REVIEW_STATUSES: {\n    PENDING: 'pending' as const,\n    APPROVED: 'approved' as const,\n    REJECTED: 'rejected' as const,\n  },\n  VALIDATION_RULES: {\n    MIN_AMOUNT: 0.01,\n    MAX_AMOUNT: 999999.99,\n    MAX_ACCOUNT_LENGTH: 500,\n  },\n  ERROR_CODES: {\n    SUBMISSION_IN_REVIEW: 'submission_in_review',\n    INVALID_AMOUNT: 'invalid_amount',\n    INVALID_ACCOUNT: 'invalid_account',\n    UNAUTHORIZED: 'unauthorized',\n    NOT_FOUND: 'not_found',\n  }\n} as const;\n","import app from 'flarum/forum/app';\r\nimport {\r\n  UserSubmissionData,\r\n  UserSubmissionListResponse,\r\n  CreateUserSubmissionPayload,\r\n  UpdateUserSubmissionPayload,\r\n  ListParams,\r\n  ValidationError,\r\n  USER_SUBMISSION_CONSTANTS\r\n} from '../../types';\r\n\r\n// Constants for the API module\r\nconst BASE_ENDPOINT = '/api/userSubmissionList';\r\nconst APPLICATION_ENDPOINT = '/api/userSubmissionApplicationList';\r\nconst MAX_RETRIES = 3;\r\nconst RETRY_DELAY = 1000; // milliseconds\r\n\r\n/**\r\n * List user submissions with advanced filtering and pagination\r\n */\r\nexport async function listUserSubmissions(params: ListParams = {}): Promise<UserSubmissionListResponse> {\r\n  try {\r\n    const queryParams = buildQueryParams(params);\r\n    const response = await requestWithRetry(\r\n      'GET',\r\n      `${BASE_ENDPOINT}${queryParams ? `?${queryParams}` : ''}`\r\n    );\r\n    \r\n    return processListResponse(response);\r\n  } catch (error) {\r\n    throw handleApiError(error, 'Failed to fetch user submissions');\r\n  }\r\n}\r\n\r\n/**\r\n * Get user applications list\r\n */\r\nexport async function listUserApplications(params: ListParams = {}): Promise<UserSubmissionListResponse> {\r\n  try {\r\n    const queryParams = buildQueryParams(params);\r\n    const response = await requestWithRetry(\r\n      'GET',\r\n      `${APPLICATION_ENDPOINT}${queryParams ? `?${queryParams}` : ''}`\r\n    );\r\n    \r\n    return processListResponse(response);\r\n  } catch (error) {\r\n    throw handleApiError(error, 'Failed to fetch user applications');\r\n  }\r\n}\r\n\r\n/**\r\n * Create a new user submission with comprehensive validation\r\n */\r\nexport async function createUserSubmission(payload: CreateUserSubmissionPayload): Promise<UserSubmissionData> {\r\n  try {\r\n    // Client-side validation\r\n    const validationErrors = validateCreatePayload(payload);\r\n    if (validationErrors.length > 0) {\r\n      throw new Error(validationErrors.map(err => err.message).join(', '));\r\n    }\r\n\r\n    const response = await requestWithRetry('POST', BASE_ENDPOINT, {\r\n      data: {\r\n        type: 'userSubmissionList',\r\n        attributes: payload\r\n      }\r\n    });\r\n\r\n    return processCreateResponse(response);\r\n  } catch (error) {\r\n    throw handleApiError(error, 'Failed to create user submission');\r\n  }\r\n}\r\n\r\n/**\r\n * Update an existing user submission\r\n */\r\nexport async function updateUserSubmission(id: string, payload: UpdateUserSubmissionPayload): Promise<UserSubmissionData> {\r\n  try {\r\n    if (!id) {\r\n      throw new Error('Submission ID is required');\r\n    }\r\n\r\n    const response = await requestWithRetry('PATCH', `${BASE_ENDPOINT}/${id}`, {\r\n      data: {\r\n        type: 'userSubmissionList',\r\n        id,\r\n        attributes: payload\r\n      }\r\n    });\r\n\r\n    return processUpdateResponse(response);\r\n  } catch (error) {\r\n    throw handleApiError(error, 'Failed to update user submission');\r\n  }\r\n}\r\n\r\n/**\r\n * Delete a user submission\r\n */\r\nexport async function deleteUserSubmission(id: string): Promise<void> {\r\n  try {\r\n    if (!id) {\r\n      throw new Error('Submission ID is required');\r\n    }\r\n\r\n    await requestWithRetry('DELETE', `${BASE_ENDPOINT}/${id}`);\r\n  } catch (error) {\r\n    throw handleApiError(error, 'Failed to delete user submission');\r\n  }\r\n}\r\n\r\n/**\r\n * Validate create payload on client side\r\n */\r\nexport function validateCreatePayload(payload: CreateUserSubmissionPayload): ValidationError[] {\r\n    const errors: ValidationError[] = [];\r\n    const { VALIDATION_RULES, ERROR_CODES } = USER_SUBMISSION_CONSTANTS;\r\n\r\n    // Amount validation\r\n    if (!payload.amount || payload.amount < VALIDATION_RULES.MIN_AMOUNT) {\r\n      errors.push({\r\n        field: 'amount',\r\n        message: app.translator.trans(`wusong8899-user-submission.lib.error.${ERROR_CODES.INVALID_AMOUNT}`)\r\n      });\r\n    }\r\n\r\n    if (payload.amount > VALIDATION_RULES.MAX_AMOUNT) {\r\n      errors.push({\r\n        field: 'amount',\r\n        message: app.translator.trans(`wusong8899-user-submission.lib.error.amount_too_large`)\r\n      });\r\n    }\r\n\r\n    // User account validation\r\n    if (!payload.userAccount || payload.userAccount.trim().length === 0) {\r\n      errors.push({\r\n        field: 'userAccount',\r\n        message: app.translator.trans(`wusong8899-user-submission.lib.error.user_account_required`)\r\n      });\r\n    }\r\n\r\n    if (payload.userAccount && payload.userAccount.length > VALIDATION_RULES.MAX_ACCOUNT_LENGTH) {\r\n      errors.push({\r\n        field: 'userAccount',\r\n        message: app.translator.trans(`wusong8899-user-submission.lib.error.user_account_too_long`)\r\n      });\r\n    }\r\n\r\n    return errors;\r\n  }\r\n\r\n/**\r\n * Build query parameters for list requests\r\n */\r\nfunction buildQueryParams(params: ListParams): string {\r\n    const queryParams = new URLSearchParams();\r\n\r\n    if (params.page) queryParams.append('page', params.page.toString());\r\n    if (params.limit) queryParams.append('limit', params.limit.toString());\r\n    if (params.sort) queryParams.append('sort', params.sort);\r\n    if (params.include) queryParams.append('include', params.include.join(','));\r\n    \r\n    if (params.filter) {\r\n      Object.entries(params.filter).forEach(([key, value]) => {\r\n        queryParams.append(`filter[${key}]`, String(value));\r\n      });\r\n    }\r\n\r\n    return queryParams.toString();\r\n  }\r\n\r\n/**\r\n * Make API request with retry logic and enhanced error handling\r\n */\r\nasync function requestWithRetry(\r\n    method: string,\r\n    url: string,\r\n    data?: any,\r\n    retryCount = 0\r\n  ): Promise<any> {\r\n    try {\r\n      const response = await app.request({\r\n        method,\r\n        url,\r\n        body: data ? JSON.stringify(data) : undefined,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json',\r\n        },\r\n      });\r\n\r\n      return response;\r\n    } catch (error: any) {\r\n      // Retry logic for network errors\r\n      if (retryCount < MAX_RETRIES && shouldRetry(error)) {\r\n        await delay(RETRY_DELAY * Math.pow(2, retryCount)); // Exponential backoff\r\n        return requestWithRetry(method, url, data, retryCount + 1);\r\n      }\r\n\r\n      throw error;\r\n    }\r\n  }\r\n\r\n/**\r\n * Determine if error should trigger a retry\r\n */\r\nfunction shouldRetry(error: any): boolean {\r\n    // Retry on network errors, timeouts, and 5xx server errors\r\n    if (!error.status) return true; // Network error\r\n    return error.status >= 500 && error.status < 600;\r\n  }\r\n\r\n/**\r\n * Delay helper for retry logic\r\n */\r\nfunction delay(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n/**\r\n * Process list response and ensure proper typing\r\n */\r\nfunction processListResponse(response: any): UserSubmissionListResponse {\r\n    // Push to store for automatic model hydration\r\n    if (response && Array.isArray(response.data)) {\r\n      response.data.forEach((item: any) => {\r\n        app.store.pushPayload({ data: item });\r\n      });\r\n    }\r\n\r\n    return {\r\n      data: response.data || [],\r\n      meta: response.meta || {}\r\n    };\r\n  }\r\n\r\n/**\r\n * Process create response\r\n */\r\nfunction processCreateResponse(response: any): UserSubmissionData {\r\n    if (response && response.data) {\r\n      app.store.pushPayload(response);\r\n      return response.data;\r\n    }\r\n    throw new Error('Invalid create response format');\r\n  }\r\n\r\n/**\r\n * Process update response\r\n */\r\nfunction processUpdateResponse(response: any): UserSubmissionData {\r\n    if (response && response.data) {\r\n      app.store.pushPayload(response);\r\n      return response.data;\r\n    }\r\n    throw new Error('Invalid update response format');\r\n  }\r\n\r\n/**\r\n * Enhanced error handling with user-friendly messages\r\n */\r\nfunction handleApiError(error: any, defaultMessage: string): Error {\r\n\r\n    // Handle validation errors from server\r\n    if (error.status === 422 && error.errors) {\r\n      const validationMessages = error.errors\r\n        .map((err: any) => err.detail || err.title)\r\n        .join(', ');\r\n      return new Error(validationMessages);\r\n    }\r\n\r\n    // Handle common HTTP status codes\r\n    switch (error.status) {\r\n      case 401:\r\n        return new Error(app.translator.trans('wusong8899-user-submission.lib.error.unauthorized'));\r\n      case 403:\r\n        return new Error(app.translator.trans('wusong8899-user-submission.lib.error.forbidden'));\r\n      case 404:\r\n        return new Error(app.translator.trans('wusong8899-user-submission.lib.error.not_found'));\r\n      case 429:\r\n        return new Error(app.translator.trans('wusong8899-user-submission.lib.error.rate_limited'));\r\n      case 500:\r\n        return new Error(app.translator.trans('wusong8899-user-submission.lib.error.server_error'));\r\n      default:\r\n        return new Error(error.message || defaultMessage);\r\n    }\r\n  }\r\n\r\n// Export a default object with all functions for backward compatibility\r\nexport default {\r\n  list: listUserSubmissions,\r\n  listApplications: listUserApplications,\r\n  create: createUserSubmission,\r\n  update: updateUserSubmission,\r\n  delete: deleteUserSubmission,\r\n  validate: validateCreatePayload\r\n};","import app from 'flarum/forum/app';\r\nimport Modal from 'flarum/common/components/Modal';\r\nimport Stream from 'flarum/common/utils/Stream';\r\nimport Button from 'flarum/common/components/Button';\r\nimport UserSubmissionApplicationSubmitSuccessModal from './UserSubmissionApplicationSubmitSuccessModal';\r\nimport { createUserSubmission } from '../services/UserSubmissionAPI';\r\nimport { StreamType, CreateUserSubmissionPayload } from '../../types';\r\nimport m from 'mithril';\r\n\r\n/**\r\n * Enhanced User Submission Application Modal with modern API integration\r\n */\r\nexport default class UserSubmissionApplicationModal extends Modal {\r\n  static isDismissibleViaBackdropClick = false;\r\n  static isDismissibleViaCloseButton = true;\r\n\r\n  private loading: boolean = false;\r\n  private error: string | null = null;\r\n  private amount: StreamType<string>;\r\n  private userAccount: StreamType<string>;\r\n\r\n  oninit(vnode: any) {\r\n    super.oninit(vnode);\r\n    this.loading = false;\r\n    this.error = null;\r\n\r\n    this.amount = Stream(\"\");\r\n    this.userAccount = Stream(\"\");\r\n  }\r\n\r\n  className(): string {\r\n    return 'Modal--small';\r\n  }\r\n\r\n  title(): string {\r\n    return app.translator.trans('wusong8899-user-submission.forum.item-header');\r\n  }\r\n\r\n  content() {\r\n    return (\r\n      <div className=\"Modal-body\">\r\n        <div className=\"Form\">\r\n          {this.error && (\r\n            <div className=\"Alert Alert--danger\">\r\n              <div className=\"Alert-body\">\r\n                {this.error}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"Form-group user-submission-modal__form-group\">\r\n              <div>\r\n                <div className=\"userSubmissionDataLabel\">{app.translator.trans('wusong8899-user-submission.lib.list-amount')}</div>\r\n                <input \r\n                  type=\"number\" \r\n                  min=\"0\" \r\n                  step=\"0.01\"\r\n                  disabled={this.loading} \r\n                  required \r\n                  className={`FormControl ${this.error && this.error.includes('amount') ? 'FormControl--error' : ''}`}\r\n                  bidi={this.amount} \r\n                />\r\n              </div>\r\n\r\n              <div className=\"userSubmissionDataLabel\">{app.translator.trans('wusong8899-user-submission.lib.list-userAccountFull')}</div>\r\n              <input \r\n                maxLength=\"500\" \r\n                disabled={this.loading} \r\n                required \r\n                className={`FormControl ${this.error && this.error.includes('userAccount') ? 'FormControl--error' : ''}`}\r\n                bidi={this.userAccount} \r\n              />\r\n          </div>\r\n\r\n          <div className=\"Form-group user-submission-modal__form-group\">\r\n            {Button.component(\r\n              {\r\n                className: 'Button Button--primary user-submission-modal__button',\r\n                type: 'submit',\r\n                loading: this.loading,\r\n              },\r\n              app.translator.trans('wusong8899-user-submission.lib.ok')\r\n            )}\r\n            {Button.component(\r\n              {\r\n                className: 'Button user-submission-modal__button',\r\n                disabled: this.loading,\r\n                onclick: () => {\r\n                  this.hide();\r\n                }\r\n              },\r\n              app.translator.trans('wusong8899-user-submission.lib.cancel')\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\n  /**\r\n   * Enhanced form submission with comprehensive error handling\r\n   */\r\n  async onsubmit(e: Event): Promise<void> {\r\n    e.preventDefault();\r\n\r\n    // Clear previous errors\r\n    this.error = null;\r\n    this.loading = true;\r\n    m.redraw();\r\n\r\n    try {\r\n      // Prepare payload with proper typing\r\n      const payload: CreateUserSubmissionPayload = {\r\n        amount: parseFloat(this.amount()) || 0,\r\n        userAccount: this.userAccount().trim()\r\n      };\r\n\r\n      // Create submission using unified API\r\n      await createUserSubmission(payload);\r\n\r\n      // Success - show success modal\r\n      this.loading = false;\r\n      this.hide();\r\n      app.modal.show(UserSubmissionApplicationSubmitSuccessModal);\r\n\r\n    } catch (error: any) {\r\n      // Handle errors gracefully\r\n      this.loading = false;\r\n      this.error = error.message || app.translator.trans('wusong8899-user-submission.lib.error.unknown');\r\n      \r\n      m.redraw();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear form data\r\n   */\r\n  private clearForm(): void {\r\n    this.amount(\"\");\r\n    this.userAccount(\"\");\r\n    this.error = null;\r\n  }\r\n\r\n  /**\r\n   * Reset form to initial state\r\n   */\r\n  private resetForm(): void {\r\n    this.clearForm();\r\n    this.loading = false;\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\r\nimport UserSubmissionApplicationModal from './UserSubmissionApplicationModal';\r\nimport LogInModal from 'flarum/forum/components/LogInModal';\r\nimport m from 'mithril';\r\n\r\ninterface UserSubmissionWidgetAttrs extends ComponentAttrs {}\r\n\r\n/**\r\n * Modernized Widget component for user submission application\r\n * Uses single rendering path with DOM manipulation for better maintainability\r\n */\r\nexport default class UserSubmissionWidget extends Component<UserSubmissionWidgetAttrs> {\r\n  private static readonly POLL_INTERVAL = 10; // milliseconds\r\n  private static readonly WIDGET_CLASS = 'UserSubmissionApplication';\r\n  private static readonly CONTAINER_SELECTOR = '.swiperTagContainer'; // 当使用 flarum-header-advertisement ，改为splideTagContainer\r\n  \r\n  private widgetElement?: HTMLElement;\r\n\r\n  oncreate(vnode: any) {\r\n    super.oncreate(vnode);\r\n    this.setupDynamicWidget();\r\n  }\r\n\r\n  onremove() {\r\n    // Cleanup dynamic widget when component is removed\r\n    if (this.widgetElement) {\r\n      this.widgetElement.remove();\r\n    }\r\n  }\r\n\r\n  view() {\r\n    // This view method is for potential direct usage\r\n    return this.renderWidgetContent();\r\n  }\r\n\r\n  /**\r\n   * Unified widget content rendering using JSX\r\n   */\r\n  private renderWidgetContent() {\r\n    return (\r\n      <div className=\"user-submission-widget\">\r\n        <div className=\"user-submission-header\">\r\n          <img \r\n            className=\"user-submission-icon\"\r\n            src=\"https://i.mji.rip/2025/08/15/102ee6e187aa177ddfe02364dc82208d.png\" \r\n            alt=\"User Submission\"\r\n          />\r\n          <span className=\"user-submission-title\">\r\n            {app.translator.trans(\"wusong8899-user-submission.forum.item-header\")}\r\n          </span>\r\n        </div>\r\n        <div className=\"user-submission-input-container\">\r\n          <div \r\n            className=\"user-submission-input-container__overlay\"\r\n            onclick={this.handleInputClick.bind(this)}\r\n          />\r\n          <div className=\"user-submission-input-container__search-input Search-input\">\r\n            <input \r\n              disabled \r\n              className=\"FormControl\" \r\n              type=\"search\" \r\n              placeholder={app.translator.trans('wusong8899-user-submission.forum.item-input-placeholder')}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Setup dynamic widget injection with modern DOM manipulation\r\n   */\r\n  private setupDynamicWidget(): void {\r\n    const pollForContainer = setInterval(() => {\r\n      const container = document.querySelector(UserSubmissionWidget.CONTAINER_SELECTOR);\r\n      \r\n      if (container && !container.classList.contains(UserSubmissionWidget.WIDGET_CLASS)) {\r\n        clearInterval(pollForContainer);\r\n        this.injectWidgetAfterContainer(container);\r\n      }\r\n    }, UserSubmissionWidget.POLL_INTERVAL);\r\n\r\n    // Cleanup timer if component is removed\r\n    setTimeout(() => clearInterval(pollForContainer), 5000); // Max 5 seconds\r\n  }\r\n\r\n  /**\r\n   * Inject widget using modern DOM APIs and Mithril rendering\r\n   */\r\n  private injectWidgetAfterContainer(container: Element): void {\r\n    container.classList.add(UserSubmissionWidget.WIDGET_CLASS);\r\n    \r\n    // Create widget container\r\n    this.widgetElement = document.createElement('div');\r\n    this.widgetElement.className = 'user-submission-widget-dynamic';\r\n    \r\n    // Insert after container\r\n    container.parentNode?.insertBefore(this.widgetElement, container.nextSibling);\r\n    \r\n    // Render widget content using Mithril\r\n    m.render(this.widgetElement, this.renderWidgetContent());\r\n  }\r\n\r\n  /**\r\n   * Enhanced click handler with better error handling\r\n   */\r\n  private handleInputClick(): void {\r\n    try {\r\n      if (app.session.user) {\r\n        app.modal.show(UserSubmissionApplicationModal);\r\n      } else {\r\n        app.modal.show(LogInModal);\r\n      }\r\n    } catch {\r\n      // Silent error handling - could be logged to a service in production\r\n    }\r\n  }\r\n}\r\n","import Model from \"flarum/common/Model\";\r\nimport User from \"flarum/common/models/User\";\r\nimport { UserSubmissionAttributes, UserSubmissionReviewResult, UserSubmissionReviewStatus } from \"../../types\";\r\n\r\n/**\r\n * Enhanced UserSubmission Model with strict typing and modern Flarum patterns\r\n */\r\nexport default class UserSubmission extends Model<UserSubmissionAttributes> {\r\n  // Core attributes with strict types\r\n  declare id: () => string;\r\n  declare amount: () => number;\r\n  declare user_account: () => string;\r\n  declare submission_user_id: () => string;\r\n  declare review_user_id: () => string | null;\r\n  declare review_result: () => UserSubmissionReviewResult | null;\r\n  declare assigned_at: () => Date;\r\n  declare reviewed_at: () => Date | null;\r\n  declare created_at: () => Date;\r\n  declare updated_at: () => Date;\r\n\r\n  // Relationship accessors with proper typing\r\n  declare fromUser: () => User | false;\r\n  declare reviewUser: () => User | null | false;\r\n\r\n  /**\r\n   * Check if submission is pending review\r\n   */\r\n  isPending(): boolean {\r\n    return this.review_result() === null && this.review_user_id() === null;\r\n  }\r\n\r\n  /**\r\n   * Check if submission is approved\r\n   */\r\n  isApproved(): boolean {\r\n    return this.review_result() === 'approved';\r\n  }\r\n\r\n  /**\r\n   * Check if submission is rejected\r\n   */\r\n  isRejected(): boolean {\r\n    return this.review_result() === 'rejected';\r\n  }\r\n\r\n  /**\r\n   * Get review status as human-readable string\r\n   */\r\n  getReviewStatus(): UserSubmissionReviewStatus {\r\n    const result = this.review_result();\r\n    if (result === 'approved') return 'approved';\r\n    if (result === 'rejected') return 'rejected';\r\n    return 'pending';\r\n  }\r\n\r\n  /**\r\n   * Get formatted amount for display\r\n   */\r\n  getFormattedAmount(): string {\r\n    return this.amount().toFixed(2);\r\n  }\r\n\r\n  /**\r\n   * Check if submission can be edited\r\n   */\r\n  canEdit(): boolean {\r\n    return this.isPending();\r\n  }\r\n\r\n  /**\r\n   * Get time since submission\r\n   */\r\n  getTimeSinceSubmission(): number {\r\n    return Date.now() - this.created_at().getTime();\r\n  }\r\n}\r\n\r\n// Modern attribute and relationship definitions\r\nObject.assign(UserSubmission.prototype, {\r\n  id: Model.attribute(\"id\"),\r\n  amount: Model.attribute(\"amount\", Number),\r\n  user_account: Model.attribute(\"user_account\"),\r\n  submission_user_id: Model.attribute(\"submission_user_id\"),\r\n  review_user_id: Model.attribute(\"review_user_id\"),\r\n  review_result: Model.attribute(\"review_result\"),\r\n  assigned_at: Model.attribute(\"assigned_at\", Model.transformDate),\r\n  reviewed_at: Model.attribute(\"reviewed_at\", Model.transformDate),\r\n  created_at: Model.attribute(\"created_at\", Model.transformDate),\r\n  updated_at: Model.attribute(\"updated_at\", Model.transformDate),\r\n\r\n  // Relationships with proper naming for better clarity\r\n  fromUser: Model.hasOne(\"fromUser\"),\r\n  reviewUser: Model.hasOne(\"reviewUser\"),\r\n});\r\n","import app from 'flarum/forum/app';\r\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\r\n\r\ninterface EmptyStateAttrs extends ComponentAttrs {\r\n  message?: string;\r\n}\r\n\r\n/**\r\n * Reusable Empty State component\r\n */\r\nexport default class EmptyState extends Component<EmptyStateAttrs> {\r\n  view() {\r\n    const { message } = this.attrs;\r\n    const displayMessage = message || app.translator.trans('wusong8899-user-submission.lib.list-empty');\r\n\r\n    return (\r\n      <div className=\"user-submission-empty-state\">\r\n        {displayMessage}\r\n      </div>\r\n    );\r\n  }\r\n}","import app from 'flarum/forum/app';\r\nimport Button from 'flarum/common/components/Button';\r\nimport Component, { ComponentAttrs } from 'flarum/common/Component';\r\n\r\ninterface LoadMoreButtonAttrs extends ComponentAttrs {\r\n  loading: boolean;\r\n  hasMore: boolean;\r\n  onClick: () => void;\r\n}\r\n\r\n/**\r\n * Reusable Load More Button component\r\n */\r\nexport default class LoadMoreButton extends Component<LoadMoreButtonAttrs> {\r\n  view() {\r\n    const { loading, hasMore, onClick } = this.attrs;\r\n\r\n    if (!hasMore || loading) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div className=\"user-submission-load-more-container\">\r\n        <Button \r\n          className=\"Button Button--primary\" \r\n          disabled={loading} \r\n          loading={loading} \r\n          onclick={onClick}\r\n        >\r\n          {app.translator.trans('wusong8899-user-submission.lib.list-load-more')}\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n}","import Component, { ComponentAttrs } from 'flarum/common/Component';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport EmptyState from './EmptyState';\r\nimport LoadMoreButton from './LoadMoreButton';\r\nimport { UserSubmissionData } from '../../types';\r\n\r\ninterface ListContainerAttrs extends ComponentAttrs {\r\n  items: UserSubmissionData[];\r\n  loading: boolean;\r\n  hasMore: boolean;\r\n  onLoadMore: () => void;\r\n  renderItem: (item: UserSubmissionData) => any;\r\n  emptyMessage?: string;\r\n  className?: string;\r\n}\r\n\r\n/**\r\n * Reusable List Container component with loading, empty states, and pagination\r\n */\r\nexport default class ListContainer extends Component<ListContainerAttrs> {\r\n  view() {\r\n    const { \r\n      items, \r\n      loading, \r\n      hasMore, \r\n      onLoadMore, \r\n      renderItem, \r\n      emptyMessage,\r\n      className = 'user-submission-list'\r\n    } = this.attrs;\r\n\r\n    return (\r\n      <div>\r\n        <ul className={className}>\r\n          {items.map((item) => (\r\n            <li key={item.id()} className={`${className}__item`}>\r\n              {renderItem(item)}\r\n            </li>\r\n          ))}\r\n        </ul>\r\n\r\n        {!loading && items.length === 0 && (\r\n          <EmptyState message={emptyMessage} />\r\n        )}\r\n\r\n        <LoadMoreButton \r\n          loading={loading}\r\n          hasMore={hasMore && !loading}\r\n          onClick={onLoadMore}\r\n        />\r\n\r\n        {loading && (\r\n          <div className=\"UserSubmission-loadMore\">\r\n            <LoadingIndicator size=\"large\" />\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}","import app from 'flarum/forum/app';\r\nimport Component, { ComponentAttrs } from \"flarum/common/Component\";\r\nimport Button from 'flarum/common/components/Button';\r\nimport { UserSubmissionData } from \"../../types\";\r\n\r\ninterface UserSubmissionApplicationListItemAttrs extends ComponentAttrs {\r\n  itemData: UserSubmissionData;\r\n}\r\n\r\nexport default class UserSubmissionApplicationListItem extends Component<UserSubmissionApplicationListItemAttrs> {\r\n\r\n  view() {\r\n    const { itemData } = this.attrs;\r\n\r\n    const amount = itemData.amount();\r\n    const id = itemData.id();\r\n    const userAccount = itemData.user_account();\r\n    const reviewResult = itemData.review_result();\r\n    const reviewResultText = app.translator.trans(\r\n      reviewResult === 'approved'\r\n        ? 'wusong8899-user-submission.lib.list-submission-accept'\r\n        : 'wusong8899-user-submission.lib.list-submission-decline'\r\n    );\r\n    const assignedAt = itemData.assigned_at();\r\n    const reviewedAt = itemData.reviewed_at();\r\n    let containerClassName = \"userSubmissionApplicationContainer \";\r\n\r\n    if (reviewedAt === null) {\r\n      containerClassName += \"userSubmissionApplicationReviewing\";\r\n    } else {\r\n      if (reviewResult === 'approved') {\r\n        containerClassName += \"userSubmissionApplicationAccepted\";\r\n      } else {\r\n        containerClassName += \"userSubmissionApplicationDeclined\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div className={containerClassName}>\r\n        <div>\r\n          <b>{app.translator.trans('wusong8899-user-submission.lib.list-id')}: </b>\r\n          {id}&nbsp;|&nbsp;\r\n          <b>{app.translator.trans('wusong8899-user-submission.lib.list-assignedAt')}: </b>\r\n          {assignedAt}\r\n        </div>\r\n        <div>\r\n          <b>{app.translator.trans('wusong8899-user-submission.lib.list-amount')}: </b>\r\n          {amount}&nbsp;|&nbsp;\r\n          <b>{app.translator.trans('wusong8899-user-submission.lib.list-userAccount')}: </b>\r\n          {userAccount}\r\n        </div>\r\n        {reviewedAt && (\r\n          <div>\r\n            <b>{app.translator.trans('wusong8899-user-submission.lib.list-reviewResult')}: </b>\r\n            {reviewResult === 'rejected' && (\r\n              <span className=\"user-submission-status user-submission-status--rejected\">{reviewResultText}&nbsp;|&nbsp;</span>\r\n            )}\r\n            {reviewResult === 'approved' && (\r\n              <span className=\"user-submission-status user-submission-status--approved\">{reviewResultText}&nbsp;|&nbsp;</span>\r\n            )}\r\n            <b>{app.translator.trans('wusong8899-user-submission.lib.list-reviewAt')}: </b>\r\n            {reviewedAt}\r\n          </div>\r\n        )}\r\n        {!reviewedAt && (\r\n          <div>\r\n            <b>{app.translator.trans('wusong8899-user-submission.lib.list-reviewResult')}: </b>\r\n            <span className=\"user-submission-status user-submission-status--reviewing\">{app.translator.trans('wusong8899-user-submission.lib.list-submission-reviewing')}</span>\r\n          </div>\r\n        )}\r\n        <div className=\"user-submission-actions\">\r\n          {Button.component({\r\n            className: 'Button Button--danger Button--small',\r\n            icon: 'fas fa-trash',\r\n            onclick: () => this.deleteItem(itemData)\r\n          }, app.translator.trans('wusong8899-user-submission.forum.delete-submission'))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private deleteItem(itemData: UserSubmissionData): void {\r\n    if (confirm(app.translator.trans('wusong8899-user-submission.forum.confirm-delete'))) {\r\n      app.request({\r\n        method: 'DELETE',\r\n        url: app.forum.attribute('apiUrl') + '/userSubmissionList/' + itemData.id(),\r\n      })\r\n        .then(() => {\r\n          // Refresh the page or remove the item from the list\r\n          window.location.reload();\r\n        })\r\n        .catch(() => {\r\n          alert(app.translator.trans('wusong8899-user-submission.forum.delete-failed'));\r\n        });\r\n    }\r\n  }\r\n}\r\n","import { UserSubmissionData } from '../../types';\r\nimport m from 'mithril';\r\n\r\ninterface PaginationState {\r\n  loading: boolean;\r\n  moreResults: boolean;\r\n  items: UserSubmissionData[];\r\n}\r\n\r\ninterface PaginationActions {\r\n  setLoading: (loading: boolean) => void;\r\n  setMoreResults: (hasMore: boolean) => void;\r\n  addItems: (newItems: UserSubmissionData[]) => void;\r\n  resetItems: () => void;\r\n  hasMoreResults: () => boolean;\r\n  loadMore: (loadFunction: (offset: number) => Promise<UserSubmissionData[]>) => Promise<void>;\r\n}\r\n\r\n/**\r\n * Custom hook for pagination logic\r\n * Since Flarum doesn't have native hooks, this is implemented as a factory function\r\n */\r\nexport function createPaginationState(): PaginationState & PaginationActions {\r\n  const state: PaginationState = {\r\n    loading: true,\r\n    moreResults: false,\r\n    items: []\r\n  };\r\n\r\n  const actions: PaginationActions = {\r\n    setLoading(loading: boolean) {\r\n      state.loading = loading;\r\n      m.redraw();\r\n    },\r\n\r\n    setMoreResults(hasMore: boolean) {\r\n      state.moreResults = hasMore;\r\n    },\r\n\r\n    addItems(newItems: UserSubmissionData[]) {\r\n      state.items.push(...newItems);\r\n    },\r\n\r\n    resetItems() {\r\n      state.items = [];\r\n    },\r\n\r\n    hasMoreResults() {\r\n      return state.moreResults;\r\n    },\r\n\r\n    async loadMore(loadFunction: (offset: number) => Promise<UserSubmissionData[]>) {\r\n      this.setLoading(true);\r\n      try {\r\n        await loadFunction(state.items.length);\r\n      } catch {\r\n        // Log error silently - could be sent to error service in production\r\n      } finally {\r\n        this.setLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  return { ...state, ...actions };\r\n}\r\n\r\n/**\r\n * Parse results helper function\r\n */\r\nexport function parseResults(\r\n  pagination: ReturnType<typeof createPaginationState>,\r\n  results: UserSubmissionData[]\r\n): UserSubmissionData[] {\r\n  pagination.setMoreResults(!!(results as any).payload?.links?.next);\r\n  pagination.addItems(results);\r\n  pagination.setLoading(false);\r\n\r\n  return results;\r\n}","import Component, { ComponentAttrs } from \"flarum/common/Component\";\r\nimport app from \"flarum/forum/app\";\r\nimport { UserSubmissionData } from \"../../types\";\r\nimport ListContainer from \"../../common/components/ListContainer\";\r\nimport UserSubmissionApplicationListItem from \"./UserSubmissionApplicationListItem\";\r\nimport { createPaginationState, parseResults } from \"../../common/hooks/usePagination\";\r\n\r\ninterface UserSubmissionApplicationListPageAttrs extends ComponentAttrs {\r\n  params: {\r\n    user: any;\r\n  };\r\n}\r\n\r\nexport default class UserSubmissionApplicationListPage extends Component<UserSubmissionApplicationListPageAttrs> {\r\n  private pagination = createPaginationState();\r\n\r\n  oninit(vnode: any) {\r\n    super.oninit(vnode);\r\n    this.loadResults();\r\n  }\r\n\r\n  view() {\r\n    return (\r\n      <ListContainer\r\n        items={this.pagination.items}\r\n        loading={this.pagination.loading}\r\n        hasMore={this.pagination.hasMoreResults()}\r\n        onLoadMore={() => this.loadMore()}\r\n        renderItem={(itemData) => UserSubmissionApplicationListItem.component({ itemData })}\r\n      />\r\n    );\r\n  }\r\n  \r\n  private loadMore(): void {\r\n    this.pagination.loadMore((offset) => this.loadResults(offset));\r\n  }\r\n\r\n  private parseResults(results: UserSubmissionData[]): UserSubmissionData[] {\r\n    return parseResults(this.pagination, results);\r\n  }\r\n\r\n  private loadResults(offset: number = 0): Promise<UserSubmissionData[]> {\r\n    return app.store\r\n      .find(\"userSubmissionApplicationList\", {\r\n        page: {\r\n          offset\r\n        },\r\n      })\r\n      .catch(() => [])\r\n      .then(this.parseResults.bind(this));\r\n  }\r\n\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport UserPage from \"flarum/forum/components/UserPage\";\r\nimport UserSubmissionApplicationListPage from \"./UserSubmissionApplicationListPage\";\r\n\r\nexport default class UserSubmissionApplicationPage extends UserPage {\r\n  oninit(vnode: any) {\r\n    super.oninit(vnode);\r\n    this.loadUser(m.route.param(\"username\"));\r\n  }\r\n\r\n  content() {\r\n    if (app.session.user) {\r\n      const currentUserID = app.session.user.id();\r\n      const targetUserID = this.user.id();\r\n\r\n      if (currentUserID === targetUserID) {\r\n        return (\r\n          <div>\r\n            {UserSubmissionApplicationListPage.component({\r\n              params: {\r\n                user: this.user,\r\n              },\r\n            })}\r\n          </div>\r\n        );\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport { extend } from \"flarum/common/extend\";\r\nimport UserPage from \"flarum/forum/components/UserPage\";\r\nimport LinkButton from \"flarum/common/components/LinkButton\";\r\n\r\nimport UserSubmissionApplicationPage from './components/UserSubmissionApplicationPage';\r\n\r\nexport default function addUserPage(): void {\r\n  app.routes[\"user.userSubmissionApplication\"] = {\r\n    path: \"/u/:username/userSubmissionApplication\",\r\n    component: UserSubmissionApplicationPage,\r\n  };\r\n\r\n  extend(UserPage.prototype, \"navItems\", function (items) {\r\n    if (app.session.user) {\r\n      const currentUserID = app.session.user.id();\r\n      const targetUserID = this.user.id();\r\n\r\n      if (currentUserID === targetUserID) {\r\n        items.add(\r\n          \"userSubmissionApplication\",\r\n          LinkButton.component({\r\n            href: app.route(\"user.userSubmissionApplication\", {\r\n              username: this.user.username(),\r\n            }),\r\n            icon: \"fas fa-file-signature\",\r\n          },\r\n            [\r\n              app.translator.trans(\r\n                \"wusong8899-user-submission.forum.application-list-title\"\r\n              )\r\n            ]\r\n          ),\r\n          10\r\n        );\r\n      }\r\n    }\r\n  });\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport Notification from \"flarum/forum/components/Notification\";\r\n\r\nexport default class UserSubmissionNotification extends Notification {\r\n  icon(): null {\r\n    return null;\r\n  }\r\n\r\n  href(): string {\r\n    return app.route(\"user.userSubmissionApplication\", {\r\n      username: app.session.user.username(),\r\n    });\r\n  }\r\n\r\n  content(): string {\r\n    this.attrs.notification.subject();\r\n    return app.translator.trans('wusong8899-user-submission.forum.notification-submission-result-title');\r\n  }\r\n\r\n  excerpt(): string | undefined {\r\n    const notification = this.attrs.notification.subject();\r\n    const reviewResult = notification.review_result();\r\n    const submissionId = notification.id();\r\n\r\n    if (reviewResult === 'approved') {\r\n      return app.translator.trans('wusong8899-user-submission.forum.notification-submission-result-success', { id: submissionId });\r\n    } else if (reviewResult === 'rejected') {\r\n      return app.translator.trans('wusong8899-user-submission.forum.notification-submission-result-failed', { id: submissionId });\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport Page from 'flarum/common/components/Page';\r\nimport IndexPage from 'flarum/forum/components/IndexPage';\r\nimport listItems from 'flarum/common/helpers/listItems';\r\n\r\nimport UserSubmissionApplicationModal from './UserSubmissionApplicationModal';\r\nimport LogInModal from \"flarum/forum/components/LogInModal\";\r\n\r\nexport default class UserSubmissionIndexPage extends Page {\r\n  oninit(vnode: any) {\r\n    super.oninit(vnode);\r\n  }\r\n\r\n  view() {\r\n    return (\r\n      <div className=\"MoneyLeaderboardPage\">\r\n        {IndexPage.prototype.hero()}\r\n\r\n        <div className=\"container\">\r\n          <div className=\"sideNavContainer\">\r\n            <nav className=\"IndexPage-nav sideNav\">\r\n              <ul>{listItems(IndexPage.prototype.sidebarItems().toArray())}</ul>\r\n            </nav>\r\n            <div className=\"user-submission-header\">\r\n              <img\r\n                className=\"user-submission-icon\"\r\n                src=\"https://mutluresim.com/images/2023/03/26/ViOux.png\"\r\n                alt=\"User Submission\"\r\n              />\r\n              &nbsp;{app.translator.trans(\"wusong8899-user-submission.forum.item-header\")}\r\n            </div>\r\n            <div className=\"user-submission-input-container\">\r\n              <div\r\n                className=\"user-submission-input-overlay\"\r\n                onclick={() => this.openModal()}\r\n              />\r\n              <div className=\"Search-input\">\r\n                <input\r\n                  disabled\r\n                  className=\"FormControl\"\r\n                  type=\"search\"\r\n                  placeholder={app.translator.trans('wusong8899-user-submission.forum.item-input-placeholder')}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private openModal(): void {\r\n    if (app.session.user) {\r\n      app.modal.show(UserSubmissionApplicationModal);\r\n    } else {\r\n      app.modal.show(LogInModal);\r\n    }\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport { extend } from 'flarum/common/extend';\r\nimport NotificationGrid from \"flarum/forum/components/NotificationGrid\";\r\nimport HeaderPrimary from 'flarum/forum/components/HeaderPrimary';\r\nimport UserSubmissionWidget from './components/UserSubmissionWidget';\r\n\r\nimport UserSubmission from \"./model/UserSubmission\";\r\nimport addUserPage from './addUserPage';\r\nimport UserSubmissionNotification from \"./components/UserSubmissionNotification\";\r\nimport UserSubmissionIndexPage from './components/UserSubmissionIndexPage';\r\n\r\napp.initializers.add('wusong8899-user-submission', () => {\r\n  app.routes['userSubmission'] = {\r\n    path: '/userSubmission',\r\n    component: UserSubmissionIndexPage,\r\n  };\r\n\r\n  app.store.models.userSubmissionList = UserSubmission;\r\n  app.notificationComponents.userSubmissionList = UserSubmissionNotification;\r\n\r\n  extend(HeaderPrimary.prototype, 'view', function () {\r\n    const routeName = app.current.get('routeName');\r\n\r\n    if (routeName === 'tags') {\r\n      // Initialize the user submission widget for the tags page\r\n      const widget = new UserSubmissionWidget();\r\n      widget.oncreate({});\r\n    }\r\n  });\r\n\r\n  extend(NotificationGrid.prototype, \"notificationTypes\", function (items) {\r\n    items.add(\"userSubmissionList\", {\r\n      name: \"userSubmissionList\",\r\n      icon: \"fas fa-file-signature\",\r\n      label: app.translator.trans(\r\n        \"wusong8899-user-submission.forum.notification-submission-result\"\r\n      ),\r\n    });\r\n  });\r\n\r\n  addUserPage();\r\n});\r\n\r\n"],"names":["_UserSubmissionApplicationSubmitSuccessModal","Modal","vnode","app","Button","UserSubmissionApplicationSubmitSuccessModal","USER_SUBMISSION_CONSTANTS","BASE_ENDPOINT","MAX_RETRIES","RETRY_DELAY","createUserSubmission","payload","validationErrors","validateCreatePayload","err","response","requestWithRetry","processCreateResponse","error","handleApiError","errors","VALIDATION_RULES","ERROR_CODES","method","url","data","retryCount","shouldRetry","delay","ms","resolve","defaultMessage","validationMessages","_UserSubmissionApplicationModal","Stream","m","e","UserSubmissionApplicationModal","_UserSubmissionWidget","Component","pollForContainer","container","LogInModal","UserSubmissionWidget","UserSubmission","Model","result","EmptyState","message","displayMessage","LoadMoreButton","loading","hasMore","onClick","ListContainer","items","onLoadMore","renderItem","emptyMessage","className","item","LoadingIndicator","UserSubmissionApplicationListItem","itemData","amount","id","userAccount","reviewResult","reviewResultText","assignedAt","reviewedAt","containerClassName","createPaginationState","state","newItems","loadFunction","parseResults","pagination","results","UserSubmissionApplicationListPage","offset","UserSubmissionApplicationPage","UserPage","currentUserID","targetUserID","addUserPage","extend","LinkButton","UserSubmissionNotification","Notification","notification","submissionId","UserSubmissionIndexPage","Page","IndexPage","listItems","HeaderPrimary","NotificationGrid"],"mappings":"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"}